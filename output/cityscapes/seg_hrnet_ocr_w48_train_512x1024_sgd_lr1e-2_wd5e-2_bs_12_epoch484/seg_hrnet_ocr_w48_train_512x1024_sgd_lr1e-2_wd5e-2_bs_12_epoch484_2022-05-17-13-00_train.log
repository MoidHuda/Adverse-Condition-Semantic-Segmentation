2022-05-17 13:00:44,419 Namespace(cfg='experiments/cityscapes/seg_hrnet_ocr_w48_train_512x1024_sgd_lr1e-2_wd5e-2_bs_12_epoch484.yaml', seed=304, local_rank=0, opts=[])
2022-05-17 13:00:44,419 AUTO_RESUME: False
CUDNN:
  BENCHMARK: True
  DETERMINISTIC: False
  ENABLED: True
DATASET:
  DATASET: cityscapes
  EXTRA_TRAIN_SET: 
  NUM_CLASSES: 19
  ROOT: data/
  TEST_SET: list/cityscapes/val.lst
  TRAIN_SET: list/cityscapes/train.lst
DEBUG:
  DEBUG: False
  SAVE_BATCH_IMAGES_GT: False
  SAVE_BATCH_IMAGES_PRED: False
  SAVE_HEATMAPS_GT: False
  SAVE_HEATMAPS_PRED: False
GPUS: (0,)
LOG_DIR: log
LOSS:
  BALANCE_WEIGHTS: [0.4, 1]
  CLASS_BALANCE: False
  OHEMKEEP: 131072
  OHEMTHRES: 0.9
  USE_OHEM: False
MODEL:
  ALIGN_CORNERS: True
  EXTRA:
    FINAL_CONV_KERNEL: 1
    STAGE1:
      BLOCK: BOTTLENECK
      FUSE_METHOD: SUM
      NUM_BLOCKS: [4]
      NUM_CHANNELS: [64]
      NUM_MODULES: 1
      NUM_RANCHES: 1
    STAGE2:
      BLOCK: BASIC
      FUSE_METHOD: SUM
      NUM_BLOCKS: [4, 4]
      NUM_BRANCHES: 2
      NUM_CHANNELS: [48, 96]
      NUM_MODULES: 1
    STAGE3:
      BLOCK: BASIC
      FUSE_METHOD: SUM
      NUM_BLOCKS: [4, 4, 4]
      NUM_BRANCHES: 3
      NUM_CHANNELS: [48, 96, 192]
      NUM_MODULES: 4
    STAGE4:
      BLOCK: BASIC
      FUSE_METHOD: SUM
      NUM_BLOCKS: [4, 4, 4, 4]
      NUM_BRANCHES: 4
      NUM_CHANNELS: [48, 96, 192, 384]
      NUM_MODULES: 3
  NAME: seg_hrnet_ocr
  NUM_OUTPUTS: 2
  OCR:
    DROPOUT: 0.05
    KEY_CHANNELS: 256
    MID_CHANNELS: 512
    SCALE: 1
  PRETRAINED: pretrained_models/hrnetv2_w48_imagenet_pretrained.pth
OUTPUT_DIR: output
PIN_MEMORY: True
PRINT_FREQ: 10
RANK: 0
TEST:
  BASE_SIZE: 2048
  BATCH_SIZE_PER_GPU: 4
  FLIP_TEST: False
  IMAGE_SIZE: [2048, 1024]
  MODEL_FILE: 
  MULTI_SCALE: False
  NUM_SAMPLES: 0
  OUTPUT_INDEX: -1
  SCALE_LIST: [1]
TRAIN:
  BASE_SIZE: 2048
  BATCH_SIZE_PER_GPU: 4
  BEGIN_EPOCH: 0
  DOWNSAMPLERATE: 1
  END_EPOCH: 484
  EXTRA_EPOCH: 0
  EXTRA_LR: 0.001
  FLIP: True
  FREEZE_EPOCHS: -1
  FREEZE_LAYERS: 
  IGNORE_LABEL: 255
  IMAGE_SIZE: [1024, 512]
  LR: 0.01
  LR_FACTOR: 0.1
  LR_STEP: [90, 110]
  MOMENTUM: 0.9
  MULTI_SCALE: True
  NESTEROV: False
  NONBACKBONE_KEYWORDS: []
  NONBACKBONE_MULT: 10
  NUM_SAMPLES: 0
  OPTIMIZER: sgd
  RANDOM_BRIGHTNESS: False
  RANDOM_BRIGHTNESS_SHIFT_VALUE: 10
  RESUME: True
  SCALE_FACTOR: 16
  SHUFFLE: True
  WD: 0.0005
WORKERS: 2
2022-05-17 13:00:44,443 Added key: store_based_barrier_key:1 to store for rank: 0
2022-05-17 13:00:44,443 Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
2022-05-17 13:00:44,810 => init weights from normal distribution
2022-05-17 13:00:45,193 => loading pretrained model pretrained_models/hrnetv2_w48_imagenet_pretrained.pth
2022-05-17 13:00:52,731 Epoch: [0/484] Iter:[0/743], Time: 5.27, lr: [0.01], Loss: 4.125969
2022-05-17 13:01:00,785 Epoch: [0/484] Iter:[10/743], Time: 1.21, lr: [0.009999749729916865], Loss: 2.943522
2022-05-17 13:01:08,879 Epoch: [0/484] Iter:[20/743], Time: 1.02, lr: [0.009999499459137766], Loss: 2.661924
2022-05-17 13:01:17,098 Epoch: [0/484] Iter:[30/743], Time: 0.96, lr: [0.00999924918766268], Loss: 2.480800
2022-05-17 13:01:25,253 Epoch: [0/484] Iter:[40/743], Time: 0.92, lr: [0.009998998915491586], Loss: 2.362909
2022-05-17 13:01:33,460 Epoch: [0/484] Iter:[50/743], Time: 0.90, lr: [0.009998748642624464], Loss: 2.294048
2022-05-17 13:01:41,707 Epoch: [0/484] Iter:[60/743], Time: 0.89, lr: [0.009998498369061292], Loss: 2.268955
2022-05-17 13:01:49,957 Epoch: [0/484] Iter:[70/743], Time: 0.88, lr: [0.009998248094802048], Loss: 2.252993
2022-05-17 13:01:58,183 Epoch: [0/484] Iter:[80/743], Time: 0.87, lr: [0.009997997819846711], Loss: 2.251882
2022-05-17 13:02:06,488 Epoch: [0/484] Iter:[90/743], Time: 0.87, lr: [0.00999774754419526], Loss: 2.191566
2022-05-17 13:02:14,779 Epoch: [0/484] Iter:[100/743], Time: 0.86, lr: [0.009997497267847672], Loss: 2.177929
2022-05-17 13:02:23,079 Epoch: [0/484] Iter:[110/743], Time: 0.86, lr: [0.009997246990803928], Loss: 2.130780
2022-05-17 13:02:31,395 Epoch: [0/484] Iter:[120/743], Time: 0.86, lr: [0.009996996713064008], Loss: 2.115127
2022-05-17 13:02:39,758 Epoch: [0/484] Iter:[130/743], Time: 0.86, lr: [0.009996746434627887], Loss: 2.094953
2022-05-17 13:02:48,154 Epoch: [0/484] Iter:[140/743], Time: 0.86, lr: [0.009996496155495546], Loss: 2.070579
2022-05-17 13:02:56,511 Epoch: [0/484] Iter:[150/743], Time: 0.85, lr: [0.009996245875666963], Loss: 2.076667
2022-05-17 13:03:04,858 Epoch: [0/484] Iter:[160/743], Time: 0.85, lr: [0.009995995595142115], Loss: 2.058849
2022-05-17 13:03:13,229 Epoch: [0/484] Iter:[170/743], Time: 0.85, lr: [0.009995745313920985], Loss: 2.057121
2022-05-17 13:03:21,676 Epoch: [0/484] Iter:[180/743], Time: 0.85, lr: [0.009995495032003547], Loss: 2.046406
2022-05-17 13:03:30,075 Epoch: [0/484] Iter:[190/743], Time: 0.85, lr: [0.009995244749389785], Loss: 2.007593
2022-05-17 13:03:38,518 Epoch: [0/484] Iter:[200/743], Time: 0.85, lr: [0.009994994466079671], Loss: 1.984513
2022-05-17 13:03:46,962 Epoch: [0/484] Iter:[210/743], Time: 0.85, lr: [0.00999474418207319], Loss: 1.968073
2022-05-17 13:03:55,429 Epoch: [0/484] Iter:[220/743], Time: 0.85, lr: [0.009994493897370315], Loss: 1.953573
2022-05-17 13:04:03,942 Epoch: [0/484] Iter:[230/743], Time: 0.85, lr: [0.00999424361197103], Loss: 1.943303
2022-05-17 13:04:12,418 Epoch: [0/484] Iter:[240/743], Time: 0.85, lr: [0.00999399332587531], Loss: 1.915216
2022-05-17 13:04:20,894 Epoch: [0/484] Iter:[250/743], Time: 0.85, lr: [0.009993743039083137], Loss: 1.901612
2022-05-17 13:04:29,428 Epoch: [0/484] Iter:[260/743], Time: 0.85, lr: [0.009993492751594486], Loss: 1.894884
2022-05-17 13:04:37,915 Epoch: [0/484] Iter:[270/743], Time: 0.85, lr: [0.009993242463409336], Loss: 1.874913
2022-05-17 13:04:46,374 Epoch: [0/484] Iter:[280/743], Time: 0.85, lr: [0.00999299217452767], Loss: 1.860353
2022-05-17 13:04:54,892 Epoch: [0/484] Iter:[290/743], Time: 0.85, lr: [0.00999274188494946], Loss: 1.839623
2022-05-17 13:05:03,409 Epoch: [0/484] Iter:[300/743], Time: 0.85, lr: [0.00999249159467469], Loss: 1.819746
2022-05-17 13:05:11,943 Epoch: [0/484] Iter:[310/743], Time: 0.85, lr: [0.009992241303703337], Loss: 1.807485
2022-05-17 13:05:20,452 Epoch: [0/484] Iter:[320/743], Time: 0.85, lr: [0.009991991012035382], Loss: 1.797165
2022-05-17 13:05:29,020 Epoch: [0/484] Iter:[330/743], Time: 0.85, lr: [0.0099917407196708], Loss: 1.784054
2022-05-17 13:05:37,604 Epoch: [0/484] Iter:[340/743], Time: 0.85, lr: [0.00999149042660957], Loss: 1.767061
2022-05-17 13:05:46,162 Epoch: [0/484] Iter:[350/743], Time: 0.85, lr: [0.009991240132851673], Loss: 1.765859
2022-05-17 13:05:54,772 Epoch: [0/484] Iter:[360/743], Time: 0.85, lr: [0.009990989838397083], Loss: 1.765358
2022-05-17 13:06:03,340 Epoch: [0/484] Iter:[370/743], Time: 0.85, lr: [0.009990739543245785], Loss: 1.751277
2022-05-17 13:06:11,853 Epoch: [0/484] Iter:[380/743], Time: 0.85, lr: [0.009990489247397755], Loss: 1.753202
2022-05-17 13:06:20,388 Epoch: [0/484] Iter:[390/743], Time: 0.85, lr: [0.009990238950852971], Loss: 1.735236
2022-05-17 13:06:28,946 Epoch: [0/484] Iter:[400/743], Time: 0.85, lr: [0.009989988653611412], Loss: 1.726604
2022-05-17 13:06:37,512 Epoch: [0/484] Iter:[410/743], Time: 0.85, lr: [0.009989738355673057], Loss: 1.710660
2022-05-17 13:06:46,094 Epoch: [0/484] Iter:[420/743], Time: 0.85, lr: [0.009989488057037883], Loss: 1.694659
2022-05-17 13:06:54,696 Epoch: [0/484] Iter:[430/743], Time: 0.85, lr: [0.00998923775770587], Loss: 1.684214
2022-05-17 13:07:03,302 Epoch: [0/484] Iter:[440/743], Time: 0.85, lr: [0.009988987457676998], Loss: 1.681352
2022-05-17 13:07:11,952 Epoch: [0/484] Iter:[450/743], Time: 0.85, lr: [0.009988737156951245], Loss: 1.678705
2022-05-17 13:07:20,531 Epoch: [0/484] Iter:[460/743], Time: 0.85, lr: [0.009988486855528587], Loss: 1.674171
2022-05-17 13:07:29,135 Epoch: [0/484] Iter:[470/743], Time: 0.85, lr: [0.009988236553409005], Loss: 1.661336
2022-05-17 13:07:37,787 Epoch: [0/484] Iter:[480/743], Time: 0.85, lr: [0.009987986250592478], Loss: 1.651543
2022-05-17 13:07:46,429 Epoch: [0/484] Iter:[490/743], Time: 0.85, lr: [0.009987735947078982], Loss: 1.638633
2022-05-17 13:07:55,100 Epoch: [0/484] Iter:[500/743], Time: 0.85, lr: [0.0099874856428685], Loss: 1.628303
2022-05-17 13:08:03,718 Epoch: [0/484] Iter:[510/743], Time: 0.85, lr: [0.009987235337961009], Loss: 1.616753
2022-05-17 13:08:12,359 Epoch: [0/484] Iter:[520/743], Time: 0.85, lr: [0.009986985032356486], Loss: 1.610011
2022-05-17 13:08:21,012 Epoch: [0/484] Iter:[530/743], Time: 0.85, lr: [0.00998673472605491], Loss: 1.601305
2022-05-17 13:08:29,743 Epoch: [0/484] Iter:[540/743], Time: 0.85, lr: [0.00998648441905626], Loss: 1.589181
2022-05-17 13:08:38,441 Epoch: [0/484] Iter:[550/743], Time: 0.85, lr: [0.009986234111360515], Loss: 1.576441
2022-05-17 13:08:47,122 Epoch: [0/484] Iter:[560/743], Time: 0.86, lr: [0.009985983802967655], Loss: 1.565133
2022-05-17 13:08:55,844 Epoch: [0/484] Iter:[570/743], Time: 0.86, lr: [0.009985733493877654], Loss: 1.554684
2022-05-17 13:09:04,570 Epoch: [0/484] Iter:[580/743], Time: 0.86, lr: [0.009985483184090496], Loss: 1.543293
2022-05-17 13:09:13,278 Epoch: [0/484] Iter:[590/743], Time: 0.86, lr: [0.009985232873606158], Loss: 1.533732
2022-05-17 13:09:22,011 Epoch: [0/484] Iter:[600/743], Time: 0.86, lr: [0.009984982562424617], Loss: 1.527730
2022-05-17 13:09:30,754 Epoch: [0/484] Iter:[610/743], Time: 0.86, lr: [0.009984732250545853], Loss: 1.517217
2022-05-17 13:09:39,461 Epoch: [0/484] Iter:[620/743], Time: 0.86, lr: [0.009984481937969844], Loss: 1.508644
2022-05-17 13:09:48,239 Epoch: [0/484] Iter:[630/743], Time: 0.86, lr: [0.009984231624696568], Loss: 1.502511
2022-05-17 13:09:57,008 Epoch: [0/484] Iter:[640/743], Time: 0.86, lr: [0.009983981310726007], Loss: 1.494564
2022-05-17 13:10:05,798 Epoch: [0/484] Iter:[650/743], Time: 0.86, lr: [0.009983730996058137], Loss: 1.490160
2022-05-17 13:10:14,605 Epoch: [0/484] Iter:[660/743], Time: 0.86, lr: [0.009983480680692935], Loss: 1.482798
2022-05-17 13:10:23,357 Epoch: [0/484] Iter:[670/743], Time: 0.86, lr: [0.009983230364630382], Loss: 1.474723
2022-05-17 13:10:32,165 Epoch: [0/484] Iter:[680/743], Time: 0.86, lr: [0.009982980047870457], Loss: 1.467893
2022-05-17 13:10:40,954 Epoch: [0/484] Iter:[690/743], Time: 0.86, lr: [0.009982729730413137], Loss: 1.461369
2022-05-17 13:10:49,769 Epoch: [0/484] Iter:[700/743], Time: 0.86, lr: [0.009982479412258402], Loss: 1.466520
2022-05-17 13:10:58,575 Epoch: [0/484] Iter:[710/743], Time: 0.86, lr: [0.00998222909340623], Loss: 1.458609
2022-05-17 13:11:07,407 Epoch: [0/484] Iter:[720/743], Time: 0.86, lr: [0.0099819787738566], Loss: 1.450270
2022-05-17 13:11:16,266 Epoch: [0/484] Iter:[730/743], Time: 0.86, lr: [0.009981728453609489], Loss: 1.442396
2022-05-17 13:11:25,097 Epoch: [0/484] Iter:[740/743], Time: 0.86, lr: [0.009981478132664878], Loss: 1.435238
2022-05-17 13:16:03,328 0 [0.89389817 0.42267688 0.73986456 0.         0.02293685 0.1049957
 0.00194647 0.12059185 0.79414461 0.27882769 0.72288462 0.47524747
 0.         0.76350582 0.         0.         0.         0.
 0.31662947] 0.2977973767226807
2022-05-17 13:16:03,329 1 [8.83509891e-01 3.98589151e-01 7.41098626e-01 0.00000000e+00
 7.84324777e-06 1.78053810e-01 0.00000000e+00 8.31596369e-02
 7.95120922e-01 2.09416528e-01 7.02078835e-01 4.73188357e-01
 0.00000000e+00 7.49517810e-01 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 2.43083848e-01] 0.28720132946040494
2022-05-17 13:16:03,329 => saving checkpoint to output/cityscapes/seg_hrnet_ocr_w48_train_512x1024_sgd_lr1e-2_wd5e-2_bs_12_epoch484checkpoint.pth.tar
2022-05-17 13:16:04,257 Loss: 0.766, MeanIU:  0.2872, Best_mIoU:  0.2872
2022-05-17 13:16:04,257 [8.83509891e-01 3.98589151e-01 7.41098626e-01 0.00000000e+00
 7.84324777e-06 1.78053810e-01 0.00000000e+00 8.31596369e-02
 7.95120922e-01 2.09416528e-01 7.02078835e-01 4.73188357e-01
 0.00000000e+00 7.49517810e-01 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 2.43083848e-01]
2022-05-17 13:16:05,489 Epoch: [1/484] Iter:[0/743], Time: 1.23, lr: [0.009981403036245477], Loss: 0.872842
2022-05-17 13:16:13,960 Epoch: [1/484] Iter:[10/743], Time: 0.88, lr: [0.009981152714394082], Loss: 0.753032
2022-05-17 13:16:22,479 Epoch: [1/484] Iter:[20/743], Time: 0.87, lr: [0.009980902391845138], Loss: 1.058266
2022-05-17 13:16:30,991 Epoch: [1/484] Iter:[30/743], Time: 0.86, lr: [0.009980652068598621], Loss: 1.002711
2022-05-17 13:16:39,561 Epoch: [1/484] Iter:[40/743], Time: 0.86, lr: [0.009980401744654512], Loss: 1.021213
2022-05-17 13:16:48,150 Epoch: [1/484] Iter:[50/743], Time: 0.86, lr: [0.009980151420012788], Loss: 1.053484
2022-05-17 13:16:56,801 Epoch: [1/484] Iter:[60/743], Time: 0.86, lr: [0.009979901094673426], Loss: 1.014984
2022-05-17 13:17:05,516 Epoch: [1/484] Iter:[70/743], Time: 0.86, lr: [0.00997965076863641], Loss: 0.990947
2022-05-17 13:17:14,289 Epoch: [1/484] Iter:[80/743], Time: 0.86, lr: [0.009979400441901713], Loss: 0.957494
2022-05-17 13:17:23,062 Epoch: [1/484] Iter:[90/743], Time: 0.87, lr: [0.009979150114469317], Loss: 0.963628
2022-05-17 13:17:31,901 Epoch: [1/484] Iter:[100/743], Time: 0.87, lr: [0.0099788997863392], Loss: 0.942152
2022-05-17 13:17:40,730 Epoch: [1/484] Iter:[110/743], Time: 0.87, lr: [0.009978649457511339], Loss: 0.925887
2022-05-17 13:17:49,605 Epoch: [1/484] Iter:[120/743], Time: 0.87, lr: [0.009978399127985716], Loss: 0.924472
2022-05-17 13:17:58,495 Epoch: [1/484] Iter:[130/743], Time: 0.87, lr: [0.009978148797762305], Loss: 0.931025
2022-05-17 13:18:07,363 Epoch: [1/484] Iter:[140/743], Time: 0.87, lr: [0.009977898466841087], Loss: 0.926844
2022-05-17 13:18:16,243 Epoch: [1/484] Iter:[150/743], Time: 0.87, lr: [0.009977648135222042], Loss: 0.939447
2022-05-17 13:18:25,117 Epoch: [1/484] Iter:[160/743], Time: 0.87, lr: [0.009977397802905148], Loss: 0.946711
2022-05-17 13:18:33,989 Epoch: [1/484] Iter:[170/743], Time: 0.88, lr: [0.009977147469890382], Loss: 0.950637
2022-05-17 13:18:42,869 Epoch: [1/484] Iter:[180/743], Time: 0.88, lr: [0.009976897136177724], Loss: 0.947651
2022-05-17 13:18:51,812 Epoch: [1/484] Iter:[190/743], Time: 0.88, lr: [0.00997664680176715], Loss: 0.942207
2022-05-17 13:19:00,751 Epoch: [1/484] Iter:[200/743], Time: 0.88, lr: [0.00997639646665864], Loss: 0.928713
2022-05-17 13:19:09,626 Epoch: [1/484] Iter:[210/743], Time: 0.88, lr: [0.009976146130852178], Loss: 0.928129
2022-05-17 13:19:18,497 Epoch: [1/484] Iter:[220/743], Time: 0.88, lr: [0.009975895794347735], Loss: 0.928414
2022-05-17 13:19:27,387 Epoch: [1/484] Iter:[230/743], Time: 0.88, lr: [0.009975645457145292], Loss: 0.937279
2022-05-17 13:19:36,241 Epoch: [1/484] Iter:[240/743], Time: 0.88, lr: [0.009975395119244829], Loss: 0.936715
2022-05-17 13:19:45,112 Epoch: [1/484] Iter:[250/743], Time: 0.88, lr: [0.009975144780646322], Loss: 0.935855
2022-05-17 13:19:53,975 Epoch: [1/484] Iter:[260/743], Time: 0.88, lr: [0.009974894441349752], Loss: 0.934868
2022-05-17 13:20:02,775 Epoch: [1/484] Iter:[270/743], Time: 0.88, lr: [0.009974644101355097], Loss: 0.928548
2022-05-17 13:20:11,580 Epoch: [1/484] Iter:[280/743], Time: 0.88, lr: [0.009974393760662335], Loss: 0.923815
2022-05-17 13:20:20,407 Epoch: [1/484] Iter:[290/743], Time: 0.88, lr: [0.009974143419271447], Loss: 0.915911
2022-05-17 13:20:29,210 Epoch: [1/484] Iter:[300/743], Time: 0.88, lr: [0.009973893077182407], Loss: 0.907205
2022-05-17 13:20:38,004 Epoch: [1/484] Iter:[310/743], Time: 0.88, lr: [0.009973642734395197], Loss: 0.902091
2022-05-17 13:20:46,794 Epoch: [1/484] Iter:[320/743], Time: 0.88, lr: [0.009973392390909793], Loss: 0.899935
2022-05-17 13:20:55,596 Epoch: [1/484] Iter:[330/743], Time: 0.88, lr: [0.009973142046726178], Loss: 0.902489
2022-05-17 13:21:04,352 Epoch: [1/484] Iter:[340/743], Time: 0.88, lr: [0.009972891701844327], Loss: 0.903734
2022-05-17 13:21:13,109 Epoch: [1/484] Iter:[350/743], Time: 0.88, lr: [0.009972641356264219], Loss: 0.905619
2022-05-17 13:21:21,906 Epoch: [1/484] Iter:[360/743], Time: 0.88, lr: [0.009972391009985832], Loss: 0.904650
2022-05-17 13:21:30,651 Epoch: [1/484] Iter:[370/743], Time: 0.88, lr: [0.009972140663009148], Loss: 0.906373
